# 善用判断式

#### 利用 test 命令的测试功能

- 关于某个文件名的 [ 文件类型 ] 判断, 如 test -e filename 表示存在否

| 测试的参数 | 意义                                                  |
| ---------- | ----------------------------------------------------- |
| -e         | 该 [ 文件名 ] 是否存在 ( 常用 )                       |
| -f         | 该 [ 文件名 ] 是否存在且为文件 ( file ) ( 常用 )      |
| -d         | 该 [ 文件名 ] 是否存在且为目录 ( directory ) ( 常用 ) |
| -b         | 该 [ 文件名 ] 是否存在且为一个 block device 设备      |
| -c         | 该 [ 文件名 ] 是否存在且为一个 character device 设备  |
| -S         | 该 [ 文件名 ] 是否存在且为一个 socket 文件            |
| -p         | 该 [ 文件名 ] 是否存在且为一个 FIFO ( pipe ) 文件     |
| -L         | 该 [ 文件名 ] 是否存在且为一个链接文件                |

- 关于文件的权限检测, 如 test -r filename 表示可读否 ( 但 root 权限常有例外 )

| 测试的参数 | 意义                                             |
| ---------- | ------------------------------------------------ |
| -r         | 检测该文件名是否存在且具有 [ 可读 ] 的权限       |
| -w         | 检测该文件名是否存在且具有 [ 可写 ] 的权限       |
| -x         | 检测该文件名是否存在且具有 [ 可执行 ] 的权限     |
| -u         | 检测该文件名是否存在且具有 [ SUID ] 的属性       |
| -g         | 检测该文件名是否存在且具有 [ SGID ] 的属性       |
| -k         | 检测该文件名是否存在且具有 [ Sticky bit ] 的属性 |
| -s         | 检测该文件名是否存在且为 [ 非空文件 ]            |

- 两个文件之间的比较, 如: test file1 -nt file2

| 测试的参数 | 意义                                                         |
| ---------- | ------------------------------------------------------------ |
| -nt        | ( newer than ) 判断 file1 是否比 file2 新                    |
| -ot        | ( older than ) 判断 file1 是否比 file2 旧                    |
| -ef        | 判断 file1 与 file2 是否为同一文件, 可用在判断 hard link 的判定上.<br />主要意义在判定, 两个文件是否均指向同一个 inode |

- 关于两个整数之间的判定, 如: test n1 -eq n2

| 测试的参数 | 意义                                     |
| ---------- | ---------------------------------------- |
| -eq        | 两数值相等 ( equal )                     |
| -ne        | 两数值不相等 ( not equal )               |
| -gt        | n1 大于 n2 (  greater than )             |
| -lt        | n1 小于 n2 ( less than )                 |
| -ge        | n1 大于等于 n2 ( greater than or equal ) |
| -le        | n1 小于等于 n2 ( less than or equal )    |

- 判定字符串的数据

| 测试的参数        | 意义                                                         |
| ----------------- | ------------------------------------------------------------ |
| test -z string    | 判定字符串是否为0? 若 string 为空字符串, 则为 true           |
| test -n string    | 判定字符串是否非为0? 若 string 为空字符串, 则为 false<br />注: -n 亦可省略 |
| test str1 == str2 | 判定 str1 是否等于 str2, 若相等, 则返回 true                 |
| test str1 != str2 | 判定 str1 是否不等于 str2, 若相等, 则返回 false              |

- 多重条件判断, 例如: test -r filename -a -x filename

| 测试的参数 | 意义                                                         |
| ---------- | ------------------------------------------------------------ |
| -a         | ( and ) 两条件同时成立.<br />例如: test -r file -a -x file, 则 file 同时具有 r 与 x 权限时, 才返回 true |
| -o         | ( or ) 两条件任何一个成立.<br />例如: test -r file -o -x file, 则 file 具有 r 或 x 权限时, 就可返回 true |
| !          | 反相状态, 如 test ! -x file, 当 file 不具有 x 时, 返回 true  |

#### 利用判断符号 []

- 在 bash 当中 = 与 == 的结果是一样的, 不过在一般常用程序的写法中
  - 一个等号代表 [ 变量的设置 ] 
  - 两个等号代表 [ 逻辑判断 ]

- 注意: 
  - 中括号的两端需要有空格符来分隔, 如: [↑"$HOME"↑==↑"$MAIL"↑]  ( ↑代表着空格 )
  - 在中括号 [] 内的每个组件都需要有空格来分隔
  - 在中括号内的变量, 最好都以双引号括号起来
  - 在中括号内的常数, 最好都以单或双引号括号起来

#### shell 脚本的默认变量 ( $0、$1... )

- 如: /path/to/scriptname opt1 opt2 opt3 opt4
  - /path/to/sctiptname 就是 $0
  - opt1 就是 $1
  - opt2 就是 $2
  - ...
- 特殊变量

| 特殊变量 | 意义                                                         |
| -------- | ------------------------------------------------------------ |
| $#       | 代表后接的参数 [ 个数 ]                                      |
| $@       | 代表 [ "$1" "$2" "$3" "$4" ] 之意, 每个变量是独立的 ( 用双引号括起来 ) |
| $*       | 代表 [ "$1c$2c$3c$4" ], 其中 c 为分隔字符, 默认为空格, 所以本例中代表 [ "$1 $2 $3 $4" ] 之意 |

- shift: 造成参数变量号码偏移

