# 基础正则表达式

#### 语系对正则表达式的影响

- 使用正则表达式时, 需要特别留意当时环境的语系是什么, 否则可能会发现与别人不相同的选取结果. 
  - LANG=C 时: 0 1 2 3 4 ... A B C D ... Z a b c d ... z
  - LANG=zh_CN 时: 0 1 2 3 4 ... a A b B c C d D ... z Z
- 特殊符号

| 特殊符号 ( 中括号也是特殊符号的一部分 ) | 代表意义                                                     |
| --------------------------------------- | ------------------------------------------------------------ |
| **[:alnum:]**                           | 代表英文大小写字符及数字, 亦即 0\~9、A\~Z、a\~z              |
| **[:alpha:]**                           | 代表任何英文大小写字符, 亦即 A\~Z、a\~z                      |
| [:blank:]                               | 代表空格键与 [Tab] 按键两者                                  |
| [:cntrl:]                               | 代表键盘上面的控制按键, 包括 CR、LF、Tab、Del等              |
| **[:digit:]**                           | 代表数字, 即 0\~9                                            |
| [:graph:]                               | 除了空格符 ( 空格键与 [Tab] 按键 ) 外的其他所有按键          |
| **[:lower:]**                           | 代表小写字符, 即 a\~z                                        |
| [:print:]                               | 代表任何可以被打印出来的字符                                 |
| [:punct:]                               | 代表标点符号, 亦即: "、'、？、!、;、:、#、$                  |
| **[:upper:]**                           | 代表大写字符, 即 A~Z                                         |
| [:space:]                               | 任何会产生空白的字符, 包括空格键、[Tab]、CR 等               |
| [:xdigit:]                              | 代表十六进制的数字类型, 因此包括 0\~9、A\~F、a\~f 的数字与字符 |

#### grep 的一些高级选项

- grep 最重要的功能就是进行字符串数据的比对, 然后将符合用户需求的字符串打印出来.
- grep 在数据中查寻一个字符串时, 是以 [整行] 为单位来进行数据的获取.
  - 也就是说, 假如一个文件内有 10 行, 其中有两行具有你所查找的字符串, 则将两行显示在屏幕上, 其他的就丢弃.
- grep [-A] [-B] [--color=auto] '查找字符' filename

| 选项与参数   | 说明                                                         |
| ------------ | ------------------------------------------------------------ |
| -A           | 后面可加数字, 为 after 的意思, 除了列出该行外, 后续的n行也列出来 |
| -B           | 后面可加数字, 为 before 的意思, 除了列出该行外, 前面的n行也列出来 |
| --color=auto | 可将正确的那个选取数据列出颜色                               |

#### 基础正则表达式字符集合

| RE字符    | 意义与范例                                                   |
| --------- | :----------------------------------------------------------- |
| ^word     | 意义: 待查找的字符串 ( word ) 在行首<br />范例: 查找regular_express.txt文件中行首为 # 开始的那一行, 并列出行号<br />grep -n '^#' regular_express.txt |
| work$     | 意义: 待查找的字符串 ( word ) 在行尾<br />范例: 将regular_express.txt文件中行尾为 ! 那一行打印出来<br />grep '!$' regular_express.txt |
| .         | 意义: 代表 [ 一定有一个任意字符 ] 的字符<br />范例: 查找的字符串可以是 ( eve )、( eae )、( eee )、( e e ), 但不能仅有( ee ), 亦即e与e中间 [一定] 仅有一个字符, 而空格符也是字符<br />grep -n 'e.e' regular_express.txt |
| \         | 意义: 转义符, 将特殊符号的特殊意义去除<br />范例: 查找含有单引号 ( ' ) 的那一行<br />grep -n \\' regular_express.txt |
| *         | 意义: 重复0个到无穷多个的前一个RE字符<br />范例: 找出含有 ( es )、( ess )、( esss ) 等的字符串, 注意, 因为 * 可以使0个, 所以 es 也是符合待查找字符串. 另外, 因为 * 为重复 [ 前一个RE字符 ] 的符号, 因此, 在 * 之前必须要紧接着一个RE字符. 例如任意字符则为 [ .* ].<br />grep -n 'ess*' regular_express.txt |
| [list]    | 意义: 字符集合的RE字符, 里面列出想要选取的字符<br />范例: 查找含有 ( gl ) 或 ( gd ) 的那一行, 需要特别留意的是, 在 [] 当中 [ 谨代表一个待查找的字符 ], 例如 [ a[afl]y ] 代表查找的字符串可以使aay、afy、aly即 [afl] 代表a或f或l的意思.<br />grep -n 'g[ld]' regular_express.txt |
| [n1-n2]   | 意义: 字符集合的RE字符, 里面列出想要选取的字符范围.<br />范例: 查找含有任意数字的那一行. 需特别留意, 在这个字符集合 [] 中的减号 - 是有特殊意义的, 它代表两个字符之间的所有连续字符. 但这个连续与否与ASCII编码有关, 因此, 你的编码需要设置正确.<br />grep -n '[0-9]' regular_express.txt |
| \[^list\] | 意义: 字符集合的RE字符, 里面列出不要的字符串范围<br />范例: 查找的字符串可以使 ( oog )、( ood ) 但不能是 ( oot ), 那个 ^ 在 [] 内时, 代表的意义是 [ 反向选择 ] 的意思.<br />grep -n 'oo[\^t]' regular_express.txt |
| \\{n,m\\} | 意义: 连续 n 到 m 个的 [ 前一个RE字符 ]<br />意义: 若为 \\{n\\} 则是连续n个的前一个RE字符<br />意义: 若为\\{n,\\} 则是连续n个以上的前一个RE字符<br />特别注意的, {} 在bash中有特殊意义, 必须要转义<br />范例: 在 g 与 g 之间有2个到3个的o存在的字符串, 亦即 ( goog )、( gooog ).<br />grep -n 'go\\{2,3\\}g' regular_express.txt |

- 正则表达式的特殊字符与一般命令行输入命令的通配符并不相同
- 特别注意的:
  - ^ : 在 [] 外代表定位在行首, 在 [] 内代表反向选择
  - $ : 在行尾
  - ^$ : 只有行首跟行尾, 可以用此找出空白行
  - . ( 小数点 ) : 代表一定有一个任意字符的意思
  - \* ( 星星号 ) : 代表重复前一个字符, 0到无穷多次的意思
  - .\* : 代表领个或多个任意字符
  - \\{\\} ( 限定范围符号 ) : 因为 {} 在shell是有特殊意义的, 因此使用时必须使用转义符\来让它失去特殊意义才行. 

#### sed 工具

- sed 本身也是一个管道命令, 可以分析标准输入. sed 还可以将数据进行替换、删除、新增、选取特定行等功能.
- sed [ -nefr ] [ 操作 ]
  - sed 后面接的操作务必以 " 两个单引号括住.

| 选项与参数 | 说明                                                         |
| ---------- | ------------------------------------------------------------ |
| -n         | 使用安静模式, 在一般sed的用法中, 所有来自 stdin 的数据一般都会被列出到屏幕上. 但如果加入 -n 参数后, 则只有经过sed特殊处理的那一行( 或操作 ) 才会被列出来. |
| -e         | 直接在命令行模式上进行sed的操作编辑.                         |
| -f         | 直接将sed的操作写在一个文件内, -f filename 则可以执行 filename 内的 sed 操作. |
| -r         | sed 的操作使用的是扩展型正则表达式的语法. ( 默认是基础正则表达式语法 ) |
| -i         | 直接修改读取的文件内容, 而不是由屏幕输出.                    |

| 操作说明:      | [n1[,n2]] function                                           |
| -------------- | ------------------------------------------------------------ |
| n1, n2         | 不见得会存在, 一般代表 [ 选择进行操作的行数 ].<br />举例来说, 如果我的操作时需要在10到20行之间进行的, 则 [ 10,20[操作行为] ].<br />( $ 代表最后一行 ) |
| function 如下: |                                                              |
| a              | 新增, a的后面可以接字符, 而这些字符会在新的一行出现( 目前的下一行 ) |
| c              | 替换, c的后面可以接字符, 这些字符可以替换n1,n2之间的行       |
| d              | 删除, 因为是删除, 所以d后面不接如何东西                      |
| i              | 插入, i的后面可以接字符, 而这些字符会在新的一行出现( 目前的上一行 )<br />多行新增, 每一行之间都必须要以反斜杠( \\ ) 来进行新行的增加. |
| p              | 打印, 亦即将某个选择的数据打印出来. 通常 p 会与参数 sed -n 一起运行 |
| s              | 替换, 可以直接进行替换的工作, 通常这个 s 的操作可以搭配正则表达式, 例如 1,20s/old/new/g就是.<br />sed 's/要被替换的字符/新的字符/g' |

