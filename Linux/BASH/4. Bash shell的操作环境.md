# Bash shell的操作环境

#### 路径与命令查找顺序

- 命令运行的顺序, 基本上可以这样看:
  1. 以相对/绝对路径执行命令, 例如 [ /bin/ls ] 或 [ ./ls ];
  2. 由alias找到该命令来执行;
  3. 由bash内置的命令来执行;
  4. 通过$PATH这个变量的顺序查找到的第一个命令来执行.
- 使用type -a 命令也可以了解到命令查找的熟悉, 如type -a ls.



#### bash登录与欢迎信息: /etc/issue、/etc/motd

- 登录画面( 在终端界面登录的时候显示的提示字符串 ) 记录在 /etc/issue 里面

| issue内的代码意义 |                                        |
| ----------------- | -------------------------------------- |
| \d                | 本地端时间的日期                       |
| \l                | 显示第几个终端界面                     |
| \m                | 显示硬件的等级(i386/i486/i586/i686...) |
| \n                | 显示主机的网络名称                     |
| \O                | 显示 domain name                       |
| \r                | 操作系统的版本(相当于 uname -r)        |
| \t                | 显示本地端时间的时间                   |
| \S                | 操作系统的名称                         |
| \v                | 操作系统的版本                         |



- 当使用telnet这个远程登录程序连接到主机时, 主机的登陆画面就会显示 /etc/issue.net 而不是 /etc/issue .

- 如果想要让用户登录后取得一些信息, 例如: 想要让大家都知道的信息. 那么可以将这些加入 /etc/motd 里面.



#### bash的环境配置文件

- login 与 non-login shell

  - login shell: 取得bash时需要完整的登录流程, 就称为login shell.
    - login shell一般只会读取这两个配置文件:
      1. /etc/profile: 这是系统整体的设置, 最好不要修改这个文件;
      2. ~/.bash_profile 或 ~/.bash_login 或 ~/.profile: 属于用户个人设置, 你要添加自己的数据, 就写入这里.
  - non-login shell: 取得bash的方法不需要重复登录的操作, 就称为non-login shell.

- /etc/profile ( login shell才会读 )

  - login shell情况下所读取的整体环境配置文件其实只有/etc/profile

| 该文件设置的主要变量 | 说明                                                 |
| -------------------- | ---------------------------------------------------- |
| PATH                 | 会根据UID决定PATH变量要不要含有sbin的系统命令目录    |
| MAIL                 | 根据账号设置好用户的mailbox到 /var/spool/mail/账号名 |
| USER                 | 根据用户的账号设置此变量内容                         |
| HOSTNAME             | 根据主机的hostname命令决定此变量内容                 |
| HISTSIZE             | 历史命令记录条数, CentOS 7.x 设置为1000              |
| umask                | 包括root默认为022, 而一般用户为002等                 |



- ~/.bash_profile ( login shell 才会读 )

  - 在login shell的bash环境下, 所读取的个人偏好配置文件其实主要有三个, 依序分别是:
    - ~/.bash_profile
    - ~/.bash_login
    - ~/.profile
  - login shell 设置只会读取上面三个文件的其中一个, 而读取的顺序则是按照上面的顺序.

- ~/.bashrc ( non-login shell会读 )

  - 当你取得non-login shell 时, 该bash配置文件仅会读取~./bashrc 而已.
  - ~/.bashrc还会调用 /etc/bashrc, 因为 etc/bashrc 帮我们的bash定义出下面的内容:
    - 根据不同的UID设置umask的值
    - 根据不同的UID设置提示字符(就是PS1变量)
    - 调用 /etc/profile.d/*.sh的设置

- 其他相关配置文件

  - /etc/man_db.conf
    - 规范了使用man的时候, man page的路径到哪里去寻找
  - ~/.bash_history
    - 默认的情况下, 我们的历史命令就记录在这里
  - ~/.bash_logout
    - 这个文件则记录了 [ 当我注销 bash 后, 系统再帮我做完什么操作后才离开 ] 



#### 终端的环境设置: stty、set

- stty ( setting tyy终端的意思 )

  - 查看目前的一些按键内容, 可以利用stty, stty也可以帮主设置终端的输入按键代表的意义.
  - stty [ -a ]

| 选项与参数 | 说明                                                         |
| ---------- | ------------------------------------------------------------ |
| -a         | 将目前所有的stty参数列出来, 即可以列出目前环境所有的按键列表. |



- 按键列表几个重要关键词:

| 关键词 | 意义                                                         |
| ------ | ------------------------------------------------------------ |
| ^      | 表示 [ Ctrl ] 这个按键的意思                                 |
| intr   | 发送一个 interrupt( 中断 ) 的信号给目前正在run的程序( 就是终止 ). |
| quit   | 发送一个quit的信号给目前正在run的程序                        |
| erase  | 向后删除字符                                                 |
| kill   | 删除在目前命令行上的所有文字                                 |
| eof    | End of file的意思, 代表 [ 结束输入 ]                         |
| start  | 在某个程序停止后, 重新启动它的output                         |
| stop   | 停止目前屏幕的输出                                           |
| susp   | 送出一个 terminal stop 的信号给正在运行的程序                |



- 设置终端输入按键代表的意义:

  - 如: stty erase ^h    <== 将[ Ctrl ] + h 设置为向后删除字符
  
    
  
- set

  - 可以利用set来设置自己的一些终端设置值

  - set [ -uvCHhmBx ]

| 选项与参数 | 说明                                                         |
| ---------- | ------------------------------------------------------------ |
| -u         | 默认不启用, 若启用后, 当使用未设置变量时, 会显示错误信息.<br />若要取消这个参数, 输入 set +u 即可. |
| -v         | 默认不启用, 若启用后, 在信息被输出前, 会先显示信息的原始内容 |
| -x         | 默认不启用, 若启用后, 在命令被执行前, 会显示命令内容 ( 前面有++符号 ) |
| -h         | 默认启用, 与历史命令有关                                     |
| -H         | 默认启用, 与历史命令有关                                     |
| -m         | 默认启用, 与任务管理有关                                     |
| -B         | 默认启用, 与中括号 [] 的作用有关                             |
| -C         | 默认不启用, 若使用 > 等, 则若文件存在时, 该文件不会被覆盖    |



- bash默认的组合键

| 组合按键 | 执行结果                            |
| -------- | ----------------------------------- |
| Ctrl + C | 终止目前的命令                      |
| Ctrl + D | 输入结束( EOF ), 例如邮件结束的时候 |
| Ctrl + M | 就是回车                            |
| Ctrl + S | 暂停屏幕的输出                      |
| Ctrl + Q | 恢复屏幕的输出                      |
| Ctrl + U | 在提示字符下, 将整列命令删除        |
| Ctrl + Z | 暂停目前的命令                      |



#### 通配符与特殊符号

- 常用的通配符

| 通配符 | 意义                                                         |
| ------ | ------------------------------------------------------------ |
| *      | 代表 [ 0个到无穷多个 ] 任意字符                              |
| ?      | 代表 [ 一定有一个 ] 任意字符                                 |
| [ ]    | 代表 [ 一定有一个在括号内 ] 的字符( 非任意字符 ).<br />例如: [abcd] 代表 [ 一定有一个字符, 可能是a、b、c、d中的任意一个 ]. |
| [ - ]  | 若有减号( - )在中括号内, 代表 [ 在编码顺序内的所有字符 ] .<br />例如: [0-9] 代表0和9之间的所有数字, 因为数字的语系编码是连续的. |
| \[^ \] | 若中括号内的第一个字符为指数符号( ^ ) , 那表示 [ 反向选择 ].<br />例如: \[^abc\] 代表一定有一个字符, 只要是非a、b、c的其他字符就接受的意思. |



- 特殊符号

| 特殊符号 | 意义                                                         |
| -------- | ------------------------------------------------------------ |
| #        | 注释符号: 这个最常被使用在脚本当中, 视为说明, 在其后面的数据均不执行. |
| \        | 转义符: 将 [ 特殊字符或通配符 ] 还原成一般字符               |
| 丨       | 管道( pipe ): 分隔两个管道命令的符号                         |
| ;        | 连续命令执行分隔符: 连续性命令的界定( 注意: 与管道命令并不相同 ) |
| ~        | 用户的家目录                                                 |
| $        | 使用变量前导符: 亦即是变量之前需要加的变量替换值             |
| &        | 任务管理: 将命令变成后台任务                                 |
| !        | 逻辑运算意义上的 [ 非 ] not 的意思                           |
| /        | 目录符号: 路径分隔的符号                                     |
| >、>>    | 数据流重定向: 输出定向, 分别是[ 替换 ] 与 [ 累加 ]           |
| <、<<    | 数据流重定向: 输入定向                                       |
| ' '      | 单引号, 不具有变量替换的功能( $变为纯文本 )                  |
| " "      | 双引号, 具有变量替换的功能( $可保留相关功能 )                |
| \` \`    | 反引号, \` \`中间为可以先执行的命令, 亦可使用 $( )           |
| ( )      | ( )中间为子shell的起始与结束                                 |
| { }      | { }中间为命令区块的组合                                      |



